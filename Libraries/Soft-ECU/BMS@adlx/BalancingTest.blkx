<?xml version="1.0" encoding="utf-8"?>

<FrameworkBuilder.SequenceFrame name="BalancingTest" library-link="Test Builder.TestCase" state="derived-meta-template" author="YoussefB" creation-date="2023-02-24T11:56:37" modification-date="2023-03-07T16:44:49" color="#4BACC6" id="{480BE744-8887-4D5F-8B3A-8D9332B939EF}" schema-version="2.3.0">
	<library-description>
		Stimulus : 
			TestCase will start a charging session with configured Parameters "BatteryStartSOC , ChargingCurrent, BalancingTimeout, SOC Threshhold", with SOC based Balancing turned on with Configured Balancing Current 
			As soon as the SOC threshold is reached balancing should start
		Evaluation :
			SOC Imbalance is evaluated, SOC Imbalance should have decreased due to Balancing 
			
	</library-description>
	<parameters>
		<MainLibrary.Dictionary name="Attributes" data-direction="in" author="dSPACE GmbH" creation-date="2012-08-01T01:00:00" modification-date="2023-02-24T13:48:19" synect-ignore="true" id="{74688B22-13F9-427D-9D98-BF968590DA28}">
			<value type="expr">{}</value>
		</MainLibrary.Dictionary>
	</parameters>
	<data-objects>
		<MainLibrary.List name="ExtraMeasurmentVars" data-direction="in" author="YoussefB" creation-date="2023-01-13T13:38:20" modification-date="2023-02-24T12:36:11" id="{4FFE3E97-DA37-4CDD-90C2-DE3E6545F117}">
			<description>Drag and Drop Signals from Mapping to this list to be added to the capture</description>
			<value type="expr">[]</value>
		</MainLibrary.List>
		<MainLibrary.DataContainer name="DCLinkVoltageStartTarget" data-direction="in" author="YoussefB" creation-date="2023-02-17T10:53:39" modification-date="2023-02-24T13:22:01">
			<description>Configure Safe start DCvoltage in precent of BatteryVoltage and timeout to reach that target voltage</description>
			<data-objects>
				<MainLibrary.Float name="TargetDCLinkVoltagePrecentage" data-direction="in" author="YoussefB" creation-date="2023-02-17T10:50:41" modification-date="2023-02-24T13:16:25">
					<value>0.95</value>
				</MainLibrary.Float>
				<MainLibrary.Float name="VoltageReachedTimeout" data-direction="in" author="YoussefB" creation-date="2023-02-17T10:53:50" modification-date="2023-02-24T13:16:25">
					<value>5</value>
				</MainLibrary.Float>
			</data-objects>
		</MainLibrary.DataContainer>
		<MainLibrary.DataContainer name="ChargingConfig" data-direction="in" author="YoussefB" creation-date="2023-02-20T13:25:05" modification-date="2023-03-01T12:44:42">
			<description>Configure Charging Session Parameters (Charging Current / BulkSOCEV /MaxChargingCurrent and Starting Battery SOC)</description>
			<data-objects>
				<MainLibrary.Float name="ChargingCurrent" data-direction="in" author="YoussefB" creation-date="2023-02-03T08:51:11" modification-date="2023-03-06T13:54:15">
					<value>100</value>
				</MainLibrary.Float>
				<MainLibrary.Float name="BulkSOCEV" data-direction="in" author="YoussefB" creation-date="2023-02-20T13:24:33" modification-date="2023-03-06T13:54:08">
					<value>80</value>
				</MainLibrary.Float>
				<MainLibrary.Float name="TargetStartSOC" data-direction="in" author="YoussefB" creation-date="2023-02-06T11:31:55" modification-date="2023-03-06T13:56:35">
					<value>79</value>
				</MainLibrary.Float>
				<MainLibrary.Float name="MaxChargingCurrent" data-direction="in" author="YoussefB" creation-date="2023-02-20T09:25:22" modification-date="2023-03-01T09:11:37">
					<value>270</value>
				</MainLibrary.Float>
			</data-objects>
		</MainLibrary.DataContainer>
		<MainLibrary.DataContainer name="BalancingSessionConfig" data-direction="in" author="YoussefB" creation-date="2023-02-24T13:21:51" modification-date="2023-03-07T16:44:48">
			<description>Configure Balancing Session Parameters  (Time, Balancing Current, Max Balancing Current, SOC Threshhold)</description>
			<data-objects>
				<MainLibrary.Float name="BalancingCurrent" data-direction="in" author="YoussefB" creation-date="2023-02-24T13:22:03" modification-date="2023-02-24T13:31:47">
					<value>1</value>
				</MainLibrary.Float>
				<MainLibrary.Float name="MaxBalancingCurrent" data-direction="in" author="YoussefB" creation-date="2023-02-24T13:22:04" modification-date="2023-02-24T13:31:48">
					<value>5</value>
				</MainLibrary.Float>
				<MainLibrary.Float name="BalancingTimeout" data-direction="in" author="YoussefB" creation-date="2023-01-09T12:37:43" modification-date="2023-03-01T09:19:12">
					<description>TestCase Stimulus will be stopped after TestTimeout, Then evaluation is Started</description>
					<value>60</value>
				</MainLibrary.Float>
				<MainLibrary.Float name="SOCThreshhold" data-direction="in" author="YoussefB" creation-date="2023-03-01T12:17:22" modification-date="2023-03-06T13:53:54">
					<value>80</value>
				</MainLibrary.Float>
			</data-objects>
		</MainLibrary.DataContainer>
	</data-objects>
	<subsystems>
		<FrameworkBuilder.ActualDataSlot name="Data" author="YoussefB" creation-date="2023-02-24T11:56:37" modification-date="2023-03-07T12:16:37">
			<library-description>
				To define meta templates.
				This block must be used inside a Frame to define dataobject slots.
			</library-description>
			<data-objects>
				<MainLibrary.List name="MainMeasurmentVars" author="YoussefB" creation-date="2023-02-24T13:18:12" modification-date="2023-03-06T15:00:09" id="{E50401C4-7DBC-446B-B549-67137D35B44B}">
					<value type="expr">
						['GetSOCImbalance',
						 'BalancingCurrent',
						 'BalancingStatus',
						 'ChargingCableStatus',
						 'GetRequestCurrent_EV']
					</value>
				</MainLibrary.List>
				<XILAPI.Capture name="Capture" author="YoussefB" creation-date="2023-02-24T13:20:12" modification-date="2023-02-24T13:20:12"></XILAPI.Capture>
				<XILAPI.CaptureResult name="CaptureResult" author="YoussefB" creation-date="2023-02-24T13:20:14" modification-date="2023-02-24T13:20:14" id="{5524502E-11D8-4EC4-AB15-3B3FCB26686F}">
					<value></value>
				</XILAPI.CaptureResult>
				<MainLibrary.List name="CellSignalsPaths" author="YoussefB" creation-date="2023-02-01T08:38:39" modification-date="2023-02-24T13:50:45" id="{66806E52-1F2A-471F-83F0-7A45BE0B0084}">
					<value type="expr">[]</value>
				</MainLibrary.List>
				<MainLibrary.List name="CellSignalNames" author="YoussefB" creation-date="2023-02-01T08:39:01" modification-date="2023-02-24T13:50:45" id="{06589FD7-A845-437F-876D-59131B1720DA}">
					<value type="expr">[]</value>
				</MainLibrary.List>
				<MainLibrary.Dictionary name="CellSignalsVarPool" author="YoussefB" creation-date="2023-02-01T08:45:50" modification-date="2023-02-24T13:50:45" id="{53518ACE-40D5-4DDE-AA1E-9E19A1BA29B3}">
					<value type="expr">{}</value>
				</MainLibrary.Dictionary>
				<MainLibrary.Float name="CellNumber" author="YoussefB" creation-date="2023-03-01T09:17:16" modification-date="2023-03-01T09:17:18">
					<value>0.0</value>
				</MainLibrary.Float>
				<MainLibrary.List name="ChargingSessionCapture" author="YoussefB" creation-date="2023-03-01T09:21:25" modification-date="2023-03-01T09:21:33" id="{F7F1A06B-A9EF-4D6A-896A-DC99C1B3894F}">
					<value type="expr">
						['ChargingCableStatus',
						 'GetRequestCurrent_EV']
					</value>
				</MainLibrary.List>
				<MainLibrary.Dictionary name="TableCellID" author="YoussefB" creation-date="2023-02-14T09:47:24" modification-date="2023-03-01T10:49:03" id="{2BFFB628-EDBD-4A2E-8B4A-D88A5AD0B90D}">
					<value type="expr">{}</value>
				</MainLibrary.Dictionary>
				<MainLibrary.Dictionary name="TableID" author="YoussefB" creation-date="2023-02-14T09:22:53" modification-date="2023-03-01T10:49:03" id="{37B868D4-A2E6-4505-8A0C-768D41772522}">
					<value type="expr">{}</value>
				</MainLibrary.Dictionary>
				<MainLibrary.String name="Styling" author="YoussefB" creation-date="2023-02-14T10:58:49" modification-date="2023-03-01T10:49:03">
					<value></value>
				</MainLibrary.String>
				<MainLibrary.Int name="PreChargeVerdict" author="YoussefB" creation-date="2023-03-06T08:35:50" modification-date="2023-03-07T12:16:37">
					<value>0</value>
				</MainLibrary.Int>
			</data-objects>
			<subsystems>
				<FrameworkBuilder.ActualOperationSlot name="Initialization" author="YoussefB" creation-date="2023-02-24T11:56:37" modification-date="2023-03-07T11:32:46">
					<library-description>
						To define meta templates.
						This block must be used inside a Frame to define a slot for blocks.
					</library-description>
					<subsystems>
						<MainLibrary.Serial name="BasicInit" author="YoussefB" creation-date="2023-02-17T09:04:32" modification-date="2023-03-07T11:32:48">
							<library-description>To execute subsystems sequentially.</library-description>
							<data-objects>
								<MainLibrary.Bool name="TimeoutFlag" author="YoussefB" creation-date="2023-02-17T10:55:16" modification-date="2023-02-24T12:36:07">
									<value>false</value>
								</MainLibrary.Bool>
							</data-objects>
							<subsystems>
								<MainLibrary.Exec name="MeasurmentVars" author="YoussefB" creation-date="2023-01-13T13:42:48" modification-date="2023-02-24T12:36:07">
									<library-description>To execute valid Python code.</library-description>
									<command>_AD_.MainMeasurmentVars.extend([x for x in _AD_.ExtraMeasurmentVars if x not in _AD_.MainMeasurmentVars])</command>
								</MainLibrary.Exec>
								<Standard.LibraryLinkBlock name="InitMAPort" library-link="XIL API Convenience.InitMAPort" author="YoussefB" creation-date="2023-01-09T12:33:29" modification-date="2023-02-24T12:36:07">
									<library-description>
										To initialize the MAPort object.
										HELP: automationdesk:///AutomationDeskDocumentation?Show=Help#12501005
									</library-description>
									<parameters>
										<XILAPI.MAPortConfiguration name="MAPortConfiguration" reference="MAPortConfiguration" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-02-24T12:36:07" id="{07F88ECB-4BB2-4063-B0FF-B82C978AB746}">
											<value type="expr">
												{'ApplicationPath':'',
												 'PlatformIdentifier':''}
											</value>
										</XILAPI.MAPortConfiguration>
										<MainLibrary.String name="Vendor" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-02-24T12:36:07">
											<custom-edit>xilapi.OpenVendorDialog()</custom-edit>
											<value>dSPACE</value>
										</MainLibrary.String>
										<XILAPI.MAPort name="MAPort" reference="MAPort" data-direction="out" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-02-24T12:36:07"></XILAPI.MAPort>
									</parameters>
								</Standard.LibraryLinkBlock>
								<Standard.LibraryLinkBlock name="GetNumberofCells" library-link="BMS.GetNumberofCells" author="YoussefB" creation-date="2023-03-01T09:17:25" modification-date="2023-03-01T09:17:25">
									<library-description>Get Number of Connected Cells</library-description>
									<parameters>
										<MainLibrary.Float name="NumberofCells_Value" reference="CellNumber" data-direction="out" author="YoussefB" creation-date="2023-01-10T08:52:15" modification-date="2023-03-01T09:17:34">
											<value>0.0</value>
										</MainLibrary.Float>
									</parameters>
								</Standard.LibraryLinkBlock>
								<FrameworkBuilder.Frame name="Cell Balancing Overview Table" library-link="Test Builder.Step" state="library-link" author="YoussefB" creation-date="2023-02-20T11:20:03" modification-date="2023-03-01T10:47:57" color="#7FFFD4">
									<library-description>
										
										To provide an element for grouping automation blocks that represent a functional unit.
										
										HELP: automationdesk:///AutomationDeskDocumentation?Show=Help#12600003
									</library-description>
									<parameters>
										<MainLibrary.Dictionary name="Attributes" data-direction="in" author="dSPACE GmbH" creation-date="2012-08-01T01:00:00" modification-date="2023-03-01T10:47:35" id="{AB884661-67D6-4BE5-88A5-7F84F4ACD2A5}">
											<value type="expr">{}</value>
										</MainLibrary.Dictionary>
									</parameters>
									<subsystems>
										<FrameworkBuilder.ActualOperationSlot name="Body" author="YoussefB" creation-date="2023-02-20T11:20:03" modification-date="2023-03-01T10:47:35">
											<library-description>
												To define meta templates.
												This block must be used inside a Frame to define a slot for blocks.
											</library-description>
											<subsystems>
												<MainLibrary.Exec name="AddOverviewTable" author="YoussefB" creation-date="2023-02-10T08:05:05" modification-date="2023-03-01T10:47:35">
													<library-description>To execute valid Python code.</library-description>
													<command>
														#CellTable------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
														
														import time
														
														HTMLTableRowStart = "&lt;tr&gt;"
														HTMLTableRowEnd = "&lt;/tr&gt;"
														HTMLTD = ""
														HTMLTableContent = ""
														i = 0
														
														
														
														Partition = 8
														
														finalverdict  = 1
														
														#id = Cell[CellNumber]
														
														for CellNumber in range(0, int(_AD_.CellNumber)):
														    i+=1
														    id = f'Cell[{CellNumber}]{time.time()}'
														    timeint = int(time.time())
														    
														    Cellid = f'Cell_{CellNumber}{timeint}'
														    _AD_.TableID[CellNumber] = id
														    _AD_.TableCellID[CellNumber] = Cellid
														    HTMLTD = HTMLTD + f'&lt;td id="{Cellid}" style="text-align: center; vertical-align: middle; border: 1px solid #555555;"&gt;&lt;a href = "#{id}"&gt; {CellNumber} &lt;/a&gt; &lt;/td&gt;'
														    
														    if i == Partition or CellNumber == _AD_.CellNumber:
														        HTMLTableContent = HTMLTableContent + HTMLTableRowStart + HTMLTD + HTMLTableRowEnd
														        HTMLTD = ""
														        i = 0
														   
														
														HTML_StringStart = f'&lt;table class="Tablee"&gt;{HTMLTableContent}&lt;/table&gt;'
														reportlibrary.AddHTML(HTML_StringStart)
														
														_AD_.Styling = '''&lt;style&gt;
														.Tablee {
														    margin-top: 4px;
														    margin-bottom: 8px;
														    width: 100%;
														    vertical-align: top; 
														    font-size: 20px;
														}
														
														a:visited{
														  color:blue;
														}
														'''
														
														
													</command>
												</MainLibrary.Exec>
											</subsystems>
										</FrameworkBuilder.ActualOperationSlot>
									</subsystems>
								</FrameworkBuilder.Frame>
								<MainLibrary.Serial name="TestCasePreConfig" author="YoussefB" creation-date="2023-02-24T13:12:36" modification-date="2023-03-07T11:32:48">
									<library-description>To execute subsystems sequentially.</library-description>
									<subsystems>
										<Standard.LibraryLinkBlock name="SetRandomCellsInitSOC%" library-link="BMS.SetRandomCellsInitSOC%" author="YoussefB" creation-date="2023-03-01T09:27:58" modification-date="2023-03-01T09:27:58">
											<library-description>Set Init SOCs of Cells to Random </library-description>
											<parameters>
												<MainLibrary.DataContainer name="RandomRange" author="YoussefB" creation-date="2023-02-28T09:08:41" modification-date="2023-03-01T09:27:58">
													<data-objects>
														<MainLibrary.Float name="From" author="YoussefB" creation-date="2023-02-28T09:08:34" modification-date="2023-03-01T12:56:07">
															<value>-1</value>
														</MainLibrary.Float>
														<MainLibrary.Float name="To" author="YoussefB" creation-date="2023-02-28T09:08:34" modification-date="2023-03-01T12:56:10">
															<value>1</value>
														</MainLibrary.Float>
													</data-objects>
												</MainLibrary.DataContainer>
											</parameters>
										</Standard.LibraryLinkBlock>
										<Standard.LibraryLinkBlock name="ResetBatterySOC" library-link="BMS.ResetBatterySOC" author="YoussefB" creation-date="2023-02-24T13:45:37" modification-date="2023-02-24T13:45:37">
											<library-description>Resets Battery SOC to Initial SOC</library-description>
										</Standard.LibraryLinkBlock>
										<FrameworkBuilder.Frame name="Configure Balancing Session" library-link="Test Builder.Step" state="library-link" author="YoussefB" creation-date="2023-03-07T11:29:00" modification-date="2023-03-07T11:30:04" color="#7FFFD4">
											<library-description>
												
												To provide an element for grouping automation blocks that represent a functional unit.
												
												HELP: automationdesk:///AutomationDeskDocumentation?Show=Help#12600003
											</library-description>
											<parameters>
												<MainLibrary.Dictionary name="Attributes" data-direction="in" author="dSPACE GmbH" creation-date="2012-08-01T01:00:00" modification-date="2023-03-07T11:29:00" id="{D1AF2353-B227-4CED-8320-8A521E5919BD}">
													<value type="expr">{}</value>
												</MainLibrary.Dictionary>
											</parameters>
											<data-objects>
												<MainLibrary.Float name="BalancingCurrent" reference="BalancingSessionConfig.BalancingCurrent" data-direction="in" author="YoussefB" creation-date="2023-03-07T11:29:36" modification-date="2023-03-07T11:31:58">
													<value>0.0</value>
												</MainLibrary.Float>
												<MainLibrary.Float name="MaxBalancingCurrent" reference="BalancingSessionConfig.MaxBalancingCurrent" data-direction="in" author="YoussefB" creation-date="2023-03-07T11:29:36" modification-date="2023-03-07T11:31:59">
													<value>0.0</value>
												</MainLibrary.Float>
												<MainLibrary.Float name="SOCThreshhold" reference="BalancingSessionConfig.SOCThreshhold" data-direction="in" author="YoussefB" creation-date="2023-03-07T11:29:39" modification-date="2023-03-07T11:32:01">
													<value>0.0</value>
												</MainLibrary.Float>
												<MainLibrary.String name="BalancingCurrentMode" data-direction="in" author="YoussefB" creation-date="2023-03-07T11:30:04" modification-date="2023-03-07T11:32:02">
													<value>Const</value>
												</MainLibrary.String>
												<MainLibrary.String name="BalancingMode" data-direction="in" author="YoussefB" creation-date="2023-03-07T11:30:04" modification-date="2023-03-07T11:32:03">
													<value>SOC</value>
												</MainLibrary.String>
											</data-objects>
											<subsystems>
												<FrameworkBuilder.ActualOperationSlot name="Body" author="YoussefB" creation-date="2023-03-07T11:29:00" modification-date="2023-03-07T11:30:39">
													<library-description>
														To define meta templates.
														This block must be used inside a Frame to define a slot for blocks.
													</library-description>
													<subsystems>
														<Standard.LibraryLinkBlock name="SetBalancingCurrent" library-link="BMS.SetBalancingCurrent" author="YoussefB" creation-date="2023-02-24T13:21:44" modification-date="2023-02-24T13:21:44">
															<library-description>To execute subsystems sequentially.</library-description>
															<parameters>
																<MainLibrary.Float name="CellBalancingCurrent_Value" reference="BalancingSessionConfig.BalancingCurrent" data-direction="in" author="YoussefB" creation-date="2023-01-16T13:45:20" modification-date="2023-02-24T13:31:54">
																	<value>0.0</value>
																</MainLibrary.Float>
															</parameters>
														</Standard.LibraryLinkBlock>
														<Standard.LibraryLinkBlock name="SetMaxBalancingCurrent" library-link="BMS.SetMaxBalancingCurrent" author="YoussefB" creation-date="2023-02-24T13:21:46" modification-date="2023-02-24T13:21:46">
															<library-description>To execute subsystems sequentially.</library-description>
															<parameters>
																<MainLibrary.Float name="CellMaxBalancingCurrent" reference="BalancingSessionConfig.MaxBalancingCurrent" data-direction="in" author="YoussefB" creation-date="2023-01-16T13:46:07" modification-date="2023-02-24T13:31:51">
																	<value>0.0</value>
																</MainLibrary.Float>
															</parameters>
														</Standard.LibraryLinkBlock>
														<Standard.LibraryLinkBlock name="SetBalancingCurrentMode" library-link="BMS.SetBalancingCurrentMode" author="YoussefB" creation-date="2023-03-01T09:29:48" modification-date="2023-03-01T09:29:48">
															<library-description>To execute subsystems sequentially.</library-description>
															<parameters>
																<MainLibrary.LabeledValue name="BalancingCurrentMode_Value" author="YoussefB" creation-date="2023-01-16T13:48:04" modification-date="2023-03-09T14:10:55" id="{E691CC59-06CE-4284-A0FA-C52CCA593C6F}">
																	<mapping type="expr">
																		{'Const':0,
																		 'VoltageBased':1}
																	</mapping>
																	<Label>
																		<value>Const</value>
																	</Label>
																</MainLibrary.LabeledValue>
															</parameters>
														</Standard.LibraryLinkBlock>
														<Standard.LibraryLinkBlock name="SetBalancingMode" library-link="BMS.SetBalancingMode" author="YoussefB" creation-date="2023-02-24T13:21:34" modification-date="2023-02-24T13:21:34">
															<library-description>To execute subsystems sequentially.</library-description>
															<parameters>
																<MainLibrary.LabeledValue name="BalancingMode_value" data-direction="in" author="YoussefB" creation-date="2023-01-09T09:55:40" modification-date="2023-03-09T14:10:55" id="{1B4DE6DB-2F9C-4C30-B5BC-071B45698294}">
																	<mapping type="expr">
																		{'SOC':0,
																		 'Voltage':1}
																	</mapping>
																	<Label>
																		<value>SOC</value>
																	</Label>
																</MainLibrary.LabeledValue>
															</parameters>
														</Standard.LibraryLinkBlock>
														<Standard.LibraryLinkBlock name="SetSOCThreshhold%" library-link="BMS.SetSOCThreshhold%" author="YoussefB" creation-date="2023-03-01T12:17:11" modification-date="2023-03-01T12:17:11">
															<library-description>To execute subsystems sequentially.</library-description>
															<parameters>
																<MainLibrary.Float name="SetBalancingSOCThreshhold" reference="BalancingSessionConfig.SOCThreshhold" data-direction="in" author="YoussefB" creation-date="2023-01-05T13:50:07" modification-date="2023-03-01T12:29:19">
																	<description>Set Initial SOC after Reset [0 - 100]</description>
																	<value>0.0</value>
																</MainLibrary.Float>
															</parameters>
														</Standard.LibraryLinkBlock>
													</subsystems>
												</FrameworkBuilder.ActualOperationSlot>
											</subsystems>
										</FrameworkBuilder.Frame>
										<MainLibrary.Exec name="AddTargetCellCaptureVars" author="YoussefB" creation-date="2023-02-24T13:17:19" modification-date="2023-03-01T12:20:23">
											<library-description>To execute valid Python code.</library-description>
											<command>
												_AD_.CellSignalsPaths = []
												_AD_.CellSignalNames = []
												_AD_.CellSignalsVarPool = {}
												
												
												for n in range(0,int(_AD_.CellNumber)) :
												    _AD_.CellSignalsPaths.append(f'{_AD_.Mapping.LabelMapping.GetBatteryCellsSOC.Identifier}[{n}]')
												    _AD_.CellSignalNames.append(f'Cell[{n}]_SOC')
												##    _AD_.CellSignalsPaths.append(f'{_AD_.Mapping.LabelMapping.GetBatteryCellsVoltage.Identifier}[{n}]')
												##    _AD_.CellSignalNames.append(f'Cell[{n}]_V')
												    _AD_.CellSignalsPaths.append(f'{_AD_.Mapping.LabelMapping.GetCellBalancingStatus.Identifier}[{n}]')
												    _AD_.CellSignalNames.append(f'Cell[{n}]_BalancingStatus')
												
												
												
												for n in _AD_.MainMeasurmentVars : 
												    _AD_.CellSignalNames.append(f'{n}')
												    _AD_.CellSignalsPaths.append(eval(f'_AD_.Mapping.LabelMapping.{n}.Identifier'))
												
												_AD_.CellSignalsVarPool = dict(zip(_AD_.CellSignalNames, _AD_.CellSignalsPaths))
											</command>
										</MainLibrary.Exec>
									</subsystems>
								</MainLibrary.Serial>
								<Standard.LibraryLinkBlock name="Init_Common" library-link="BMS.Init_Common" author="YoussefB" creation-date="2023-01-30T16:18:08" modification-date="2023-02-28T08:54:46">
									<library-description>A serial that Contains Common initialization Steps, that are called at the Initialization phase of Testcases</library-description>
								</Standard.LibraryLinkBlock>
								<Standard.LibraryLinkBlock name="WaitForPreChargeCircuitReady" library-link="BMS.WaitForPreChargeCircuitReady" author="YoussefB" creation-date="2023-02-24T13:16:11" modification-date="2023-03-06T09:11:38">
									<library-description>Wait until PreCharge Circuit is Ready for Testing (Relays in appropriate Position + DCLink Voltage is at least The Defined % of the Battery Voltage)</library-description>
									<parameters>
										<MainLibrary.Float name="TimeOutDuration" reference="DCLinkVoltageStartTarget.VoltageReachedTimeout" data-direction="in" author="YoussefB" creation-date="2023-01-09T13:17:16" modification-date="2023-02-24T13:16:37">
											<value>0</value>
										</MainLibrary.Float>
										<MainLibrary.Float name="TargetVoltage" reference="DCLinkVoltageStartTarget.TargetDCLinkVoltagePrecentage" data-direction="in" author="YoussefB" creation-date="2023-02-17T10:51:54" modification-date="2023-02-24T13:16:40">
											<value>0.0</value>
										</MainLibrary.Float>
										<MainLibrary.Int name="Verdict" reference="PreChargeVerdict" data-direction="out" author="YoussefB" creation-date="2023-03-06T08:33:45" modification-date="2023-03-07T12:24:06">
											<value>0</value>
										</MainLibrary.Int>
									</parameters>
								</Standard.LibraryLinkBlock>
							</subsystems>
						</MainLibrary.Serial>
						<FrameworkBuilder.DataSlot name="InitData" author="YoussefB" creation-date="2023-02-24T14:43:21" modification-date="2023-02-24T14:43:29">
							<library-description>
								To define meta templates.
								This block must be used inside a Frame to define dataobject slots.
							</library-description>
							<subsystems>
								<FrameworkBuilder.OperationSlot name="Init" author="YoussefB" creation-date="2023-02-24T14:43:23" modification-date="2023-02-24T14:43:32">
									<library-description>
										To define meta templates.
										This block must be used inside a Frame to define a slot for blocks.
									</library-description>
								</FrameworkBuilder.OperationSlot>
							</subsystems>
						</FrameworkBuilder.DataSlot>
						<FrameworkBuilder.Frame name="Configure Charging Session" library-link="Test Builder.Step" state="library-link" author="YoussefB" creation-date="2023-02-20T13:24:14" modification-date="2023-03-01T09:12:12" color="#7FFFD4">
							<library-description>
								
								To provide an element for grouping automation blocks that represent a functional unit.
								
								HELP: automationdesk:///AutomationDeskDocumentation?Show=Help#12600003
							</library-description>
							<parameters>
								<MainLibrary.Dictionary name="Attributes" data-direction="in" author="dSPACE GmbH" creation-date="2012-08-01T01:00:00" modification-date="2023-03-01T09:12:12" id="{F4D48EC0-2764-4A8F-BB98-52810E1AC6B6}">
									<value type="expr">{}</value>
								</MainLibrary.Dictionary>
							</parameters>
							<data-objects>
								<MainLibrary.Float name="StartBatSOC" reference="ChargingConfig.TargetStartSOC" data-direction="in" author="YoussefB" creation-date="2023-02-20T13:26:42" modification-date="2023-03-01T09:12:12">
									<value>0.0</value>
								</MainLibrary.Float>
								<MainLibrary.Float name="ChargingCurrent" reference="ChargingConfig.ChargingCurrent" data-direction="in" author="YoussefB" creation-date="2023-02-20T13:24:33" modification-date="2023-03-01T09:12:12">
									<value>0.0</value>
								</MainLibrary.Float>
								<MainLibrary.Float name="BulkSOCEV" reference="ChargingConfig.BulkSOCEV" data-direction="in" author="YoussefB" creation-date="2023-02-20T13:24:33" modification-date="2023-03-01T09:12:12">
									<value>0.0</value>
								</MainLibrary.Float>
								<MainLibrary.Float name="MaxChargingCurrent" reference="ChargingConfig.MaxChargingCurrent" data-direction="in" author="YoussefB" creation-date="2023-02-23T11:08:37" modification-date="2023-03-01T09:12:12">
									<value>0.0</value>
								</MainLibrary.Float>
							</data-objects>
							<subsystems>
								<FrameworkBuilder.ActualOperationSlot name="Body" author="YoussefB" creation-date="2023-02-20T13:24:14" modification-date="2023-03-01T09:12:12">
									<library-description>
										To define meta templates.
										This block must be used inside a Frame to define a slot for blocks.
									</library-description>
									<subsystems>
										<Standard.LibraryLinkBlock name="SetChargingCurrent" library-link="BMS.SetChargingCurrent" author="YoussefB" creation-date="2023-02-03T14:49:03" modification-date="2023-03-01T09:12:12">
											<library-description>To execute subsystems sequentially.</library-description>
											<parameters>
												<MainLibrary.Float name="ChargingCurrentValue" reference="ChargingConfig.ChargingCurrent" data-direction="in" author="YoussefB" creation-date="2023-01-05T15:11:04" modification-date="2023-03-01T09:12:12">
													<description>Max EVSE Power in KW</description>
													<value>150</value>
												</MainLibrary.Float>
											</parameters>
										</Standard.LibraryLinkBlock>
										<Standard.LibraryLinkBlock name="SetBulkSOC_EV" library-link="BMS.SetBulkSOC_EV" author="YoussefB" creation-date="2023-02-03T14:48:48" modification-date="2023-03-01T09:12:12">
											<library-description>Set bulk SOC ev</library-description>
											<parameters>
												<MainLibrary.Float name="EVBulkSOC_Value" reference="ChargingConfig.BulkSOCEV" data-direction="in" author="YoussefB" creation-date="2023-01-05T15:50:13" modification-date="2023-03-01T09:12:12">
													<description>EV Bulk SOC %</description>
													<value>95</value>
												</MainLibrary.Float>
											</parameters>
										</Standard.LibraryLinkBlock>
										<Standard.LibraryLinkBlock name="ResetBatteryToTargetSOC" library-link="BMS.ResetBatteryToTargetSOC" author="YoussefB" creation-date="2023-02-03T15:04:40" modification-date="2023-03-01T09:12:12">
											<library-description>To execute subsystems sequentially.</library-description>
											<parameters>
												<MainLibrary.Float name="TargetSOC" reference="ChargingConfig.TargetStartSOC" data-direction="in" author="YoussefB" creation-date="2023-01-06T12:02:24" modification-date="2023-03-01T09:12:12">
													<description>Input Target SOC in %</description>
													<value>80</value>
												</MainLibrary.Float>
											</parameters>
										</Standard.LibraryLinkBlock>
										<Standard.LibraryLinkBlock name="SetMaxCurrent_EVSE" library-link="BMS.SetMaxCurrent_EVSE" author="YoussefB" creation-date="2023-02-20T09:25:16" modification-date="2023-03-01T09:12:12">
											<library-description>To execute subsystems sequentially.</library-description>
											<parameters>
												<MainLibrary.Float name="EVSEMaxCurrent_Value" reference="ChargingConfig.MaxChargingCurrent" data-direction="in" author="YoussefB" creation-date="2023-01-05T15:06:35" modification-date="2023-03-01T09:12:12">
													<description>Max EVSE Current in Ampere</description>
													<value>0.0</value>
												</MainLibrary.Float>
											</parameters>
										</Standard.LibraryLinkBlock>
									</subsystems>
								</FrameworkBuilder.ActualOperationSlot>
							</subsystems>
						</FrameworkBuilder.Frame>
						<MainLibrary.Serial name="MainCapture" author="YoussefB" creation-date="2023-02-24T13:16:01" modification-date="2023-03-01T12:46:05">
							<library-description>To execute subsystems sequentially.</library-description>
							<subsystems>
								<Standard.LibraryLinkBlock name="InitializeCapture" library-link="XIL API Convenience.InitializeCapture" author="YoussefB" creation-date="2023-02-01T08:38:07" modification-date="2023-02-24T13:20:00" color="#FFA500">
									<library-description>
										To create and initialize a XIL API capture.
										HELP: automationdesk:///AutomationDeskDocumentation?Show=Help#12502001
									</library-description>
									<parameters>
										<XILAPI.MAPort name="MAPort" reference="MAPort" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-02-24T13:20:00"></XILAPI.MAPort>
										<MainLibrary.String name="TaskName" reference="TaskName" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-02-24T13:20:00">
											<custom-edit>
												xilapi.OpenTaskNameDialog(MAPortAvailable=False)
												
											</custom-edit>
											<value></value>
										</MainLibrary.String>
										<MainLibrary.Variant name="VariablePool" reference="CellSignalsVarPool" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-02-24T13:53:31" id="{91545989-8993-4BF5-ACB0-F3F97CCC2CDD}">
											<value type="expr">None</value>
										</MainLibrary.Variant>
										<MainLibrary.List name="Variables" reference="CellSignalNames" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-02-24T13:53:36" id="{EAB11216-25B8-427A-9A14-F13BC4DB0D19}">
											<custom-edit>
												xilapi.OpenVariableListDialog(MAPortAvailable=True)
												
											</custom-edit>
											<value type="expr">[]</value>
										</MainLibrary.List>
										<MainLibrary.Int name="Downsampling" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-02-24T13:20:00">
											<value>1</value>
										</MainLibrary.Int>
										<MainLibrary.Float name="DefaultDuration" reference="BalancingSessionConfig.BalancingTimeout" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-03-01T09:20:06">
											<value>20</value>
										</MainLibrary.Float>
										<XILAPI.Capture name="Capture" reference="Capture" data-direction="out" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-02-24T13:20:00"></XILAPI.Capture>
									</parameters>
								</Standard.LibraryLinkBlock>
								<Standard.LibraryLinkBlock name="ConfigureStartCondition" library-link="XIL API Convenience.ConfigureStartCondition" author="YoussefB" creation-date="2023-02-23T15:15:05" modification-date="2023-02-24T13:20:00" color="#FFA500">
									<library-description>
										To specify a start condition of a capture.
										
										HELP: automationdesk:///AutomationDeskDocumentation?Show=Help#12502002
									</library-description>
									<parameters>
										<XILAPI.Capture name="Capture" reference="Capture" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-02-24T13:20:00"></XILAPI.Capture>
										<MainLibrary.Variant name="Defines" reference="Mapping" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-02-24T13:20:00" id="{00289736-C72B-486A-A95F-F262EF1F5FC9}">
											<value type="expr">None</value>
										</MainLibrary.Variant>
										<MainLibrary.String name="Condition" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-03-01T10:00:43">
											<custom-edit>
												Value, PressedButton = dialogslibrary.EnterGESExpression(
												                        Expression = _AD_._VALUE_,
												                        Identifier = xilapi.GetConditionDefines(_AD_.Defines),
												                        Title = 'Value Editor - Condition' )
												
												if PressedButton == dialogslibrary.BUTTON_OK:
												    _AD_._VALUE_ = Value
											</custom-edit>
											<value>ChargingCableStatus == 1</value>
										</MainLibrary.String>
										<MainLibrary.Float name="Delay" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-03-06T15:38:50">
											<value>1</value>
										</MainLibrary.Float>
										<MainLibrary.Float name="TimeOut" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-03-01T09:25:27">
											<value>10</value>
										</MainLibrary.Float>
									</parameters>
								</Standard.LibraryLinkBlock>
								<Standard.LibraryLinkBlock name="ConfigureStopCondition" library-link="XIL API Convenience.ConfigureStopCondition" author="YoussefB" creation-date="2023-02-24T14:26:22" modification-date="2023-02-24T14:26:33" color="#FFA500">
									<library-description>
										To specify a stop condition of a capture.
										
										HELP: automationdesk:///AutomationDeskDocumentation?Show=Help#12502003
									</library-description>
									<parameters>
										<XILAPI.Capture name="Capture" reference="Capture" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-02-24T14:26:37"></XILAPI.Capture>
										<MainLibrary.Variant name="Defines" reference="Mapping" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-02-24T14:37:29" id="{888DC8D9-E104-4E99-9494-162B61DEA2C8}">
											<value type="expr">None</value>
										</MainLibrary.Variant>
										<MainLibrary.String name="Condition" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-03-01T13:07:19">
											<custom-edit>
												Value, PressedButton = dialogslibrary.EnterGESExpression(
												                        Expression = _AD_._VALUE_,
												                        Identifier = xilapi.GetConditionDefines(_AD_.Defines),
												                        Title = 'Value Editor - Condition' )
												
												if PressedButton == dialogslibrary.BUTTON_OK:
												    _AD_._VALUE_ = Value
											</custom-edit>
											<value>GetSOCImbalance &lt;= 1</value>
										</MainLibrary.String>
										<MainLibrary.Float name="Delay" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-02-24T14:26:22">
											<value>0.0</value>
										</MainLibrary.Float>
										<MainLibrary.Float name="TimeOut" reference="BalancingSessionConfig.BalancingTimeout" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-03-01T12:45:52">
											<value>10.0</value>
										</MainLibrary.Float>
									</parameters>
								</Standard.LibraryLinkBlock>
								<Standard.LibraryLinkBlock name="StartCapture" library-link="XIL API Convenience.StartCapture" author="YoussefB" creation-date="2023-02-01T11:48:43" modification-date="2023-02-24T13:20:00" color="#FFA500">
									<library-description>
										Starts the data logging.
										
										HELP: automationdesk:///AutomationDeskDocumentation?Show=Help#12502010
									</library-description>
									<parameters>
										<XILAPI.Capture name="Capture" reference="Capture" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-02-24T13:20:00"></XILAPI.Capture>
										<XILAPI.CaptureResultWriter name="CaptureResultWriter" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-02-24T13:20:00"></XILAPI.CaptureResultWriter>
									</parameters>
								</Standard.LibraryLinkBlock>
							</subsystems>
						</MainLibrary.Serial>
					</subsystems>
				</FrameworkBuilder.ActualOperationSlot>
				<FrameworkBuilder.ActualOperationSlot name="ActionsAndEvaluation" author="YoussefB" creation-date="2023-02-24T11:56:37" modification-date="2023-03-07T12:16:57">
					<library-description>
						To define meta templates.
						This block must be used inside a Frame to define a slot for blocks.
					</library-description>
					<subsystems>
						<MainLibrary.IfThenElse name="Check PreChargeCircuit" author="YoussefB" creation-date="2023-03-06T08:35:13" modification-date="2023-03-07T12:16:48">
							<library-description>To execute a conditional command with a specified alternative.</library-description>
							<If modification-date="2023-03-07T12:16:57">
								<Condition name="Condition" modification-date="2023-03-07T12:16:48">
									<value>_AD_.PreChargeVerdict == 1</value>
								</Condition>
								<subsystems>
									<MainLibrary.Serial name="Evaluation" author="YoussefB" creation-date="2023-02-24T13:36:37" modification-date="2023-03-01T12:43:43">
										<library-description>To execute subsystems sequentially.</library-description>
										<data-objects>
											<MainLibrary.File name="TempFileName" author="YoussefB" creation-date="2023-03-01T10:56:53" modification-date="2023-03-01T10:56:55">
												<value type="file"></value>
											</MainLibrary.File>
										</data-objects>
										<subsystems>
											<FrameworkBuilder.Frame name="BalancingStarted" library-link="Test Builder.Step" state="library-link" author="YoussefB" creation-date="2023-02-24T14:05:52" modification-date="2023-02-24T14:05:58" color="#7FFFD4">
												<library-description>
													
													To provide an element for grouping automation blocks that represent a functional unit.
													
													HELP: automationdesk:///AutomationDeskDocumentation?Show=Help#12600003
												</library-description>
												<parameters>
													<MainLibrary.Dictionary name="Attributes" data-direction="in" author="dSPACE GmbH" creation-date="2012-08-01T01:00:00" modification-date="2023-02-24T14:05:52" id="{C38E5B47-EB26-4C4D-A563-EE8829EBD477}">
														<value type="expr">{}</value>
													</MainLibrary.Dictionary>
												</parameters>
												<subsystems>
													<FrameworkBuilder.ActualOperationSlot name="Body" author="YoussefB" creation-date="2023-02-24T14:05:52" modification-date="2023-02-24T14:05:53">
														<library-description>
															To define meta templates.
															This block must be used inside a Frame to define a slot for blocks.
														</library-description>
														<subsystems>
															<Standard.LibraryLinkBlock name="SetBalancingStatus" library-link="BMS.SetBalancingStatus" author="YoussefB" creation-date="2023-02-24T13:54:43" modification-date="2023-02-24T13:54:43">
																<library-description>To execute subsystems sequentially.</library-description>
																<parameters>
																	<MainLibrary.LabeledValue name="BalancingStatus_Value" data-direction="in" author="YoussefB" creation-date="2023-01-09T09:59:28" modification-date="2023-03-09T14:10:55" id="{45050D29-FD74-43F6-BB6D-1249A8EEFBC1}">
																		<mapping type="expr">
																			{'OFF':0,
																			 'ON':1}
																		</mapping>
																		<Label>
																			<value>ON</value>
																		</Label>
																	</MainLibrary.LabeledValue>
																</parameters>
															</Standard.LibraryLinkBlock>
														</subsystems>
													</FrameworkBuilder.ActualOperationSlot>
												</subsystems>
											</FrameworkBuilder.Frame>
											<FrameworkBuilder.Frame name="ConnectChargingCable" library-link="Test Builder.Step" state="library-link" author="YoussefB" creation-date="2023-02-20T13:27:25" modification-date="2023-03-01T09:23:14" color="#7FFFD4">
												<library-description>
													
													To provide an element for grouping automation blocks that represent a functional unit.
													
													HELP: automationdesk:///AutomationDeskDocumentation?Show=Help#12600003
												</library-description>
												<parameters>
													<MainLibrary.Dictionary name="Attributes" data-direction="in" author="dSPACE GmbH" creation-date="2012-08-01T01:00:00" modification-date="2023-03-01T09:23:14" id="{2B341102-9A5A-459B-9911-609C5F2D6F75}">
														<value type="expr">{}</value>
													</MainLibrary.Dictionary>
												</parameters>
												<subsystems>
													<FrameworkBuilder.ActualOperationSlot name="Body" author="YoussefB" creation-date="2023-02-20T13:27:25" modification-date="2023-03-01T09:23:14">
														<library-description>
															To define meta templates.
															This block must be used inside a Frame to define a slot for blocks.
														</library-description>
														<subsystems>
															<Standard.LibraryLinkBlock name="Connect" library-link="BMS.SetChargingCableStatus" author="YoussefB" creation-date="2023-02-03T14:49:10" modification-date="2023-03-01T09:23:14">
																<library-description>To execute subsystems sequentially.</library-description>
																<parameters>
																	<MainLibrary.LabeledValue name="SetChargingCableStatus_Value" data-direction="in" author="YoussefB" creation-date="2023-01-09T11:35:38" modification-date="2023-03-09T14:10:55" id="{D32428C7-3169-49A5-8796-54131DF90BD7}">
																		<mapping type="expr">
																			{'Disconnected':0,
																			 'Connected':1}
																		</mapping>
																		<Label>
																			<value>Connected</value>
																		</Label>
																	</MainLibrary.LabeledValue>
																</parameters>
															</Standard.LibraryLinkBlock>
														</subsystems>
													</FrameworkBuilder.ActualOperationSlot>
												</subsystems>
											</FrameworkBuilder.Frame>
											<FrameworkBuilder.Frame name="WaitingForCaptureResult" library-link="Test Builder.Step" state="library-link" author="YoussefB" creation-date="2023-02-24T14:06:01" modification-date="2023-02-24T14:06:09" color="#7FFFD4">
												<library-description>
													
													To provide an element for grouping automation blocks that represent a functional unit.
													
													HELP: automationdesk:///AutomationDeskDocumentation?Show=Help#12600003
												</library-description>
												<parameters>
													<MainLibrary.Dictionary name="Attributes" data-direction="in" author="dSPACE GmbH" creation-date="2012-08-01T01:00:00" modification-date="2023-02-24T14:06:01" id="{A13347DA-B3EC-4706-B815-18C8FB7AB38D}">
														<value type="expr">{}</value>
													</MainLibrary.Dictionary>
												</parameters>
												<subsystems>
													<FrameworkBuilder.ActualOperationSlot name="Body" author="YoussefB" creation-date="2023-02-24T14:06:01" modification-date="2023-02-24T14:06:03">
														<library-description>
															To define meta templates.
															This block must be used inside a Frame to define a slot for blocks.
														</library-description>
														<subsystems>
															<Standard.LibraryLinkBlock name="GetCaptureResult" library-link="XIL API Convenience.GetCaptureResult" author="YoussefB" creation-date="2023-02-24T13:37:18" modification-date="2023-02-24T13:37:23" color="#FFA500">
																<library-description>
																	To get data from the capture and set the capture state.
																	
																	HELP: automationdesk:///AutomationDeskDocumentation?Show=Help#12502006
																</library-description>
																<parameters>
																	<XILAPI.Capture name="Capture" reference="Capture" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-02-24T13:37:25"></XILAPI.Capture>
																	<MainLibrary.Int name="StopCapturing" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-02-24T13:37:18">
																		<value>1</value>
																	</MainLibrary.Int>
																	<MainLibrary.Int name="WhenFinished" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-02-24T13:37:27">
																		<value>1</value>
																	</MainLibrary.Int>
																	<MainLibrary.Dictionary name="CaptureResultMetaData" data-direction="out" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-02-24T13:37:18" id="{1FD40422-8319-4C35-A650-8B25A2660928}">
																		<value type="expr">{}</value>
																	</MainLibrary.Dictionary>
																	<XILAPI.CaptureResult name="CaptureResult" reference="CaptureResult" data-direction="out" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-02-24T13:37:29" id="{526F43EF-7F69-4398-B008-5CDC985307B2}">
																		<value></value>
																	</XILAPI.CaptureResult>
																	<XILAPI.CaptureResult name="OfflineCaptureResult" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-02-24T13:37:18" id="{50D52997-A94C-469C-BD7B-6DDE3192D69C}">
																		<value></value>
																	</XILAPI.CaptureResult>
																	<MainLibrary.Dictionary name="OfflineCaptureResultMetaData" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-02-24T13:37:18" id="{39D73059-93BD-4619-AFA9-5F1ADB2162AD}">
																		<value type="expr">
																			{'StartTriggerTimeOut':'FALSE',
																			 'StopTriggerTimeOut':'FALSE'}
																		</value>
																	</MainLibrary.Dictionary>
																</parameters>
															</Standard.LibraryLinkBlock>
														</subsystems>
													</FrameworkBuilder.ActualOperationSlot>
												</subsystems>
											</FrameworkBuilder.Frame>
											<FrameworkBuilder.Frame name="DisconnectChargingCable" library-link="Test Builder.Step" state="library-link" author="YoussefB" creation-date="2023-02-20T13:28:05" modification-date="2023-03-01T09:23:14" color="#7FFFD4">
												<library-description>
													
													To provide an element for grouping automation blocks that represent a functional unit.
													
													HELP: automationdesk:///AutomationDeskDocumentation?Show=Help#12600003
												</library-description>
												<parameters>
													<MainLibrary.Dictionary name="Attributes" data-direction="in" author="dSPACE GmbH" creation-date="2012-08-01T01:00:00" modification-date="2023-03-01T09:23:14" id="{1591FB40-5929-49F2-9D45-2A2473706C14}">
														<value type="expr">{}</value>
													</MainLibrary.Dictionary>
												</parameters>
												<subsystems>
													<FrameworkBuilder.ActualOperationSlot name="Body" author="YoussefB" creation-date="2023-02-20T13:28:05" modification-date="2023-03-01T09:23:14">
														<library-description>
															To define meta templates.
															This block must be used inside a Frame to define a slot for blocks.
														</library-description>
														<subsystems>
															<Standard.LibraryLinkBlock name="Disconnect" library-link="BMS.SetChargingCableStatus" author="YoussefB" creation-date="2023-02-03T14:49:10" modification-date="2023-03-01T09:23:14">
																<library-description>To execute subsystems sequentially.</library-description>
																<parameters>
																	<MainLibrary.LabeledValue name="SetChargingCableStatus_Value" data-direction="in" author="YoussefB" creation-date="2023-01-09T11:35:38" modification-date="2023-03-09T14:10:55" id="{8EF8CE96-1EED-42F6-AA25-F6E268D4ECD0}">
																		<mapping type="expr">
																			{'Disconnected':0,
																			 'Connected':1}
																		</mapping>
																		<Label>
																			<value>Disconnected</value>
																		</Label>
																	</MainLibrary.LabeledValue>
																</parameters>
															</Standard.LibraryLinkBlock>
														</subsystems>
													</FrameworkBuilder.ActualOperationSlot>
												</subsystems>
											</FrameworkBuilder.Frame>
											<FrameworkBuilder.Frame name="BalancingTurnedOFF" library-link="Test Builder.Step" state="library-link" author="YoussefB" creation-date="2023-02-24T14:06:11" modification-date="2023-02-24T14:06:20" color="#7FFFD4">
												<library-description>
													
													To provide an element for grouping automation blocks that represent a functional unit.
													
													HELP: automationdesk:///AutomationDeskDocumentation?Show=Help#12600003
												</library-description>
												<parameters>
													<MainLibrary.Dictionary name="Attributes" data-direction="in" author="dSPACE GmbH" creation-date="2012-08-01T01:00:00" modification-date="2023-02-24T14:06:11" id="{82131617-48FB-490C-9832-6A5490D0A833}">
														<value type="expr">{}</value>
													</MainLibrary.Dictionary>
												</parameters>
												<subsystems>
													<FrameworkBuilder.ActualOperationSlot name="Body" author="YoussefB" creation-date="2023-02-24T14:06:11" modification-date="2023-02-24T14:06:13">
														<library-description>
															To define meta templates.
															This block must be used inside a Frame to define a slot for blocks.
														</library-description>
														<subsystems>
															<Standard.LibraryLinkBlock name="SetBalancingStatus" library-link="BMS.SetBalancingStatus" author="YoussefB" creation-date="2023-02-24T13:36:49" modification-date="2023-02-24T13:36:49">
																<library-description>To execute subsystems sequentially.</library-description>
																<parameters>
																	<MainLibrary.LabeledValue name="BalancingStatus_Value" data-direction="in" author="YoussefB" creation-date="2023-01-09T09:59:28" modification-date="2023-03-09T14:10:55" id="{CF8FCD13-DB96-4725-B42D-4DB9DCC46055}">
																		<mapping type="expr">
																			{'OFF':0,
																			 'ON':1}
																		</mapping>
																		<Label>
																			<value>OFF</value>
																		</Label>
																	</MainLibrary.LabeledValue>
																</parameters>
															</Standard.LibraryLinkBlock>
														</subsystems>
													</FrameworkBuilder.ActualOperationSlot>
												</subsystems>
											</FrameworkBuilder.Frame>
											<FrameworkBuilder.Frame name="Evaluating" library-link="Test Builder.Step" state="library-link" author="YoussefB" creation-date="2023-02-24T14:06:26" modification-date="2023-02-24T14:06:31" color="#7FFFD4">
												<library-description>
													
													To provide an element for grouping automation blocks that represent a functional unit.
													
													HELP: automationdesk:///AutomationDeskDocumentation?Show=Help#12600003
												</library-description>
												<parameters>
													<MainLibrary.Dictionary name="Attributes" data-direction="in" author="dSPACE GmbH" creation-date="2012-08-01T01:00:00" modification-date="2023-02-24T14:06:26" id="{1D3983BB-8FB6-4AC9-A206-9E62AD20B4F4}">
														<value type="expr">{}</value>
													</MainLibrary.Dictionary>
												</parameters>
												<subsystems>
													<FrameworkBuilder.ActualOperationSlot name="Body" author="YoussefB" creation-date="2023-02-24T14:06:26" modification-date="2023-03-01T11:01:03">
														<library-description>
															To define meta templates.
															This block must be used inside a Frame to define a slot for blocks.
														</library-description>
														<subsystems>
															<MainLibrary.Exec name="AdjustStop" author="YoussefB" creation-date="2023-03-01T11:00:57" modification-date="2023-03-01T11:01:14">
																<library-description>To execute valid Python code.</library-description>
																<command>_AD_.CellNumber = _AD_.CellNumber - 1</command>
															</MainLibrary.Exec>
															<MainLibrary.Serial name="Eval" author="YoussefB" creation-date="2023-02-24T13:37:51" modification-date="2023-03-07T10:42:40">
																<library-description>To execute subsystems sequentially.</library-description>
																<data-objects>
																	<Evaluation.Signal name="SOCImbalance" author="YoussefB" creation-date="2023-02-24T13:37:58" modification-date="2023-03-01T12:16:51" id="{20BEFE24-6990-44AA-AA1F-199263AAB3DF}">
																		<library-description>A signal data object consisting of (x,y) value pairs.</library-description>
																		<value>[], []</value>
																	</Evaluation.Signal>
																	<MainLibrary.List name="SOCImbalanceTrueTimes" data-direction="in" author="YoussefB" creation-date="2023-02-24T13:40:02" modification-date="2023-03-01T12:16:56" id="{4B4A901F-33C2-4E0A-ACF6-EC4945F08862}">
																		<value type="expr">[]</value>
																	</MainLibrary.List>
																	<MainLibrary.Float name="MinSOCImbalance" author="YoussefB" creation-date="2023-02-24T13:59:29" modification-date="2023-03-01T12:18:30">
																		<value>0.0</value>
																	</MainLibrary.Float>
																	<MainLibrary.List name="BalancingStartList" author="YoussefB" creation-date="2023-03-07T09:55:58" modification-date="2023-03-07T09:56:03" id="{5E1A923B-9BF6-4C0C-A547-675E2BF271EF}">
																		<value type="expr">[]</value>
																	</MainLibrary.List>
																</data-objects>
																<subsystems>
																	<MainLibrary.For name="For" author="YoussefB" creation-date="2023-02-03T12:47:18" modification-date="2023-03-02T12:27:40">
																		<library-description>To iterate an operation block with a predefined number of iterations.</library-description>
																		<Current name="Current" modification-date="2023-03-01T10:47:02">
																			<value>0</value>
																		</Current>
																		<Start name="Start" modification-date="2023-03-01T10:47:02">
																			<value>0</value>
																		</Start>
																		<Stop name="Stop" reference="CellNumber" modification-date="2023-03-01T10:47:02">
																			<value>2</value>
																		</Stop>
																		<Step name="Step" modification-date="2023-03-01T10:47:02">
																			<value>1</value>
																		</Step>
																		<data-objects>
																			<MainLibrary.String name="BalancingStatusPath" author="YoussefB" creation-date="2023-02-06T14:55:10" modification-date="2023-03-01T10:52:35">
																				<value></value>
																			</MainLibrary.String>
																			<MainLibrary.String name="SOCPath" author="YoussefB" creation-date="2023-02-06T14:55:10" modification-date="2023-03-01T10:54:52">
																				<value></value>
																			</MainLibrary.String>
																			<Evaluation.Signal name="BalancingStatus" author="YoussefB" creation-date="2023-03-01T10:53:53" modification-date="2023-03-01T10:54:06" id="{1C704D4F-5E2E-470D-A44E-0199087AD92A}">
																				<library-description>A signal data object consisting of (x,y) value pairs.</library-description>
																				<value>[], []</value>
																			</Evaluation.Signal>
																			<Evaluation.Signal name="SOC" author="YoussefB" creation-date="2023-03-01T10:53:56" modification-date="2023-03-01T10:54:12" id="{467B6283-1613-4FFB-8CC2-A14021E609D4}">
																				<library-description>A signal data object consisting of (x,y) value pairs.</library-description>
																				<value>[], []</value>
																			</Evaluation.Signal>
																			<MainLibrary.String name="Condition" author="YoussefB" creation-date="2023-03-02T11:27:42" modification-date="2023-03-02T11:27:49">
																				<value></value>
																			</MainLibrary.String>
																			<MainLibrary.List name="SOCTrueTimes" author="YoussefB" creation-date="2023-03-02T11:34:28" modification-date="2023-03-02T11:34:32" id="{04E84484-FC73-4E86-98A3-7C4976043D29}">
																				<value type="expr">[]</value>
																			</MainLibrary.List>
																			<Evaluation.Signal name="BalancingON" author="YoussefB" creation-date="2023-03-02T12:09:29" modification-date="2023-03-02T12:09:34" id="{F1B65D63-DCC2-4F56-817C-4D74AF6B7E15}">
																				<library-description>A signal data object consisting of (x,y) value pairs.</library-description>
																				<value>[], []</value>
																			</Evaluation.Signal>
																			<Evaluation.Signal name="BalancingOFF" author="YoussefB" creation-date="2023-03-02T12:09:29" modification-date="2023-03-02T12:09:37" id="{531EC43E-70AF-4538-A1FC-EC026B4F4986}">
																				<library-description>A signal data object consisting of (x,y) value pairs.</library-description>
																				<value>[], []</value>
																			</Evaluation.Signal>
																			<MainLibrary.List name="BalancingONList" author="YoussefB" creation-date="2023-03-02T12:10:23" modification-date="2023-03-02T12:10:28" id="{293B8F9F-4BC1-4989-BBDB-52FA78D7FC55}">
																				<value type="expr">[]</value>
																			</MainLibrary.List>
																			<MainLibrary.List name="BalancingOFFList" author="YoussefB" creation-date="2023-03-02T12:10:23" modification-date="2023-03-02T12:10:33" id="{03675A18-FBEC-4F3C-8548-9129DC9EEA74}">
																				<value type="expr">[]</value>
																			</MainLibrary.List>
																			<Evaluation.Signal name="SOCON" author="YoussefB" creation-date="2023-03-02T12:13:24" modification-date="2023-03-02T12:13:32" id="{120D4421-AEAF-4F29-930F-A2019A60A3EA}">
																				<library-description>A signal data object consisting of (x,y) value pairs.</library-description>
																				<value>[], []</value>
																			</Evaluation.Signal>
																			<Evaluation.Signal name="SOCOFF" author="YoussefB" creation-date="2023-03-02T12:13:25" modification-date="2023-03-02T12:13:35" id="{05986641-FDA9-4B8C-BF5C-9FEBCABD3087}">
																				<library-description>A signal data object consisting of (x,y) value pairs.</library-description>
																				<value>[], []</value>
																			</Evaluation.Signal>
																		</data-objects>
																		<subsystems>
																			<MainLibrary.Exec name="EvalPrep" author="YoussefB" creation-date="2023-02-03T12:13:50" modification-date="2023-03-01T12:27:07">
																				<library-description>To execute valid Python code.</library-description>
																				<command>
																					_AD_.BalancingStatusPath =  _AD_.CellSignalsVarPool[f'Cell[{_AD_.Current}]_BalancingStatus']
																					_AD_.SOCPath =  _AD_.CellSignalsVarPool[f'Cell[{_AD_.Current}]_SOC']
																					
																					reportlibrary.AddHTML(f'&lt;div id="{_AD_.TableID[_AD_.Current]}"&gt;&lt;h2&gt;Cell[{_AD_.Current}]&lt;/h2&gt;&lt;/div&gt;')
																					
																					
																					  
																				</command>
																			</MainLibrary.Exec>
																			<Evaluation.GetSignalFromXILAPICaptureResult name="GetBalancingStatus" author="YoussefB" creation-date="2023-02-03T14:06:29" modification-date="2023-03-01T10:54:19">
																				<library-description>To get a signal by converting data extracted from a XILAPI CaptureResult.</library-description>
																				<CaptureResult name="CaptureResult" reference="CaptureResult" modification-date="2023-03-01T10:47:02">
																					<value></value>
																				</CaptureResult>
																				<Task name="Task" reference="TaskName" modification-date="2023-03-01T10:47:02">
																					<value></value>
																				</Task>
																				<VariableName name="VariableName" reference="BalancingStatusPath" modification-date="2023-03-01T10:55:43">
																					<value></value>
																				</VariableName>
																				<Signal name="Signal" reference="BalancingStatus" modification-date="2023-03-01T10:55:46">
																					<value>[], []</value>
																				</Signal>
																			</Evaluation.GetSignalFromXILAPICaptureResult>
																			<Evaluation.GetSignalFromXILAPICaptureResult name="GetSOC" author="YoussefB" creation-date="2023-02-03T14:06:29" modification-date="2023-03-01T10:53:47">
																				<library-description>To get a signal by converting data extracted from a XILAPI CaptureResult.</library-description>
																				<CaptureResult name="CaptureResult" reference="CaptureResult" modification-date="2023-03-01T10:53:38">
																					<value></value>
																				</CaptureResult>
																				<Task name="Task" reference="TaskName" modification-date="2023-03-01T10:53:38">
																					<value></value>
																				</Task>
																				<VariableName name="VariableName" reference="SOCPath" modification-date="2023-03-01T10:56:21">
																					<value></value>
																				</VariableName>
																				<Signal name="Signal" reference="SOC" modification-date="2023-03-01T10:56:25">
																					<value>[], []</value>
																				</Signal>
																			</Evaluation.GetSignalFromXILAPICaptureResult>
																			<Evaluation.GetConditionTrueTimes name="GetConditionTrueTimesBalancingON" author="YoussefB" creation-date="2023-02-06T15:08:51" modification-date="2023-03-01T10:47:16">
																				<library-description>To get the time values of a signal where a specified condition is fulfilled.</library-description>
																				<Condition name="Condition" modification-date="2023-03-01T10:57:18">
																					<value>Signal == 1</value>
																				</Condition>
																				<xAxis name="X-Axis" modification-date="2023-03-01T10:47:02">
																					<value>Union</value>
																				</xAxis>
																				<Interpolation name="Interpolation" modification-date="2023-03-01T10:47:02">
																					<value>Linear</value>
																				</Interpolation>
																				<ConditionTrueTimes name="ConditionTrueTimes" reference="BalancingONList" modification-date="2023-03-02T12:27:31">
																					<value type="expr">[]</value>
																				</ConditionTrueTimes>
																				<Result name="Result" reference="BalancingON" modification-date="2023-03-02T12:09:47">
																					<value>[], []</value>
																				</Result>
																				<data-objects>
																					<Evaluation.Signal name="Signal" reference="BalancingStatus" author="YoussefB" creation-date="2023-02-06T15:08:58" modification-date="2023-03-01T10:57:14" id="{849F1D26-62C5-4095-8383-E1EDA4C0D4A9}">
																						<library-description>A signal data object consisting of (x,y) value pairs.</library-description>
																						<value>[], []</value>
																					</Evaluation.Signal>
																				</data-objects>
																			</Evaluation.GetConditionTrueTimes>
																			<Evaluation.GetConditionTrueTimes name="GetConditionTrueTimesBalancingOFF" author="YoussefB" creation-date="2023-02-06T15:08:51" modification-date="2023-03-02T12:09:19">
																				<library-description>To get the time values of a signal where a specified condition is fulfilled.</library-description>
																				<Condition name="Condition" modification-date="2023-03-02T12:09:52">
																					<value>Signal == 0</value>
																				</Condition>
																				<xAxis name="X-Axis" modification-date="2023-03-02T12:09:11">
																					<value>Union</value>
																				</xAxis>
																				<Interpolation name="Interpolation" modification-date="2023-03-02T12:09:11">
																					<value>Linear</value>
																				</Interpolation>
																				<ConditionTrueTimes name="ConditionTrueTimes" reference="BalancingOFFList" modification-date="2023-03-02T12:27:38">
																					<value type="expr">[]</value>
																				</ConditionTrueTimes>
																				<Result name="Result" reference="BalancingOFF" modification-date="2023-03-02T12:09:56">
																					<value>[], []</value>
																				</Result>
																				<data-objects>
																					<Evaluation.Signal name="Signal" reference="BalancingStatus" author="YoussefB" creation-date="2023-02-06T15:08:58" modification-date="2023-03-02T12:09:52" id="{53824D14-7AAB-4413-94F2-8577EA08E450}">
																						<library-description>A signal data object consisting of (x,y) value pairs.</library-description>
																						<value>[], []</value>
																					</Evaluation.Signal>
																				</data-objects>
																			</Evaluation.GetConditionTrueTimes>
																			<MainLibrary.IfThenElse name="CropOFF" author="YoussefB" creation-date="2023-03-02T12:14:12" modification-date="2023-03-07T12:15:52" hide-else="true">
																				<library-description>To execute a conditional command with a specified alternative.</library-description>
																				<If modification-date="2023-03-02T12:14:14">
																					<Condition name="Condition" modification-date="2023-03-02T12:14:43">
																						<value>len(_AD_.BalancingOFFList) != 0</value>
																					</Condition>
																					<subsystems>
																						<Evaluation.CropByBooleanSignal name="CropSOCOFF" author="YoussefB" creation-date="2023-03-02T12:13:19" modification-date="2023-03-07T11:59:45">
																							<library-description>To crop a signal by a boolean signal.</library-description>
																							<Signal name="Signal" reference="SOC" modification-date="2023-03-02T12:15:50">
																								<value>[], []</value>
																							</Signal>
																							<Where name="BooleanSignal" reference="BalancingOFF" modification-date="2023-03-02T12:15:56">
																								<value>[], []</value>
																							</Where>
																							<Result name="Result" reference="SOCOFF" modification-date="2023-03-02T12:16:02">
																								<value>[], []</value>
																							</Result>
																						</Evaluation.CropByBooleanSignal>
																					</subsystems>
																				</If>
																				<Else modification-date="2023-03-02T12:14:12"></Else>
																			</MainLibrary.IfThenElse>
																			<MainLibrary.IfThenElse name="CropOn" author="YoussefB" creation-date="2023-03-02T12:14:09" modification-date="2023-03-02T12:14:27" hide-else="true">
																				<library-description>To execute a conditional command with a specified alternative.</library-description>
																				<If modification-date="2023-03-07T09:56:10">
																					<Condition name="Condition" modification-date="2023-03-02T12:15:19">
																						<value>len(_AD_.BalancingONList) != 0</value>
																					</Condition>
																					<subsystems>
																						<Evaluation.CropByBooleanSignal name="CropSOCON" author="YoussefB" creation-date="2023-03-02T12:13:17" modification-date="2023-03-07T12:15:53">
																							<library-description>To crop a signal by a boolean signal.</library-description>
																							<Signal name="Signal" reference="SOC" modification-date="2023-03-02T12:13:49">
																								<value>[], []</value>
																							</Signal>
																							<Where name="BooleanSignal" reference="BalancingON" modification-date="2023-03-02T12:13:55">
																								<value>[], []</value>
																							</Where>
																							<Result name="Result" reference="SOCON" modification-date="2023-03-02T12:13:58">
																								<value>[], []</value>
																							</Result>
																						</Evaluation.CropByBooleanSignal>
																						<MainLibrary.Exec name="Add Balancing StartTimeStamp" author="YoussefB" creation-date="2023-03-07T09:56:10" modification-date="2023-03-07T10:59:58">
																							<library-description>To execute valid Python code.</library-description>
																							<command>_AD_.BalancingStartList.append(_AD_.BalancingONList[0])</command>
																						</MainLibrary.Exec>
																					</subsystems>
																				</If>
																				<Else modification-date="2023-03-02T12:14:09"></Else>
																			</MainLibrary.IfThenElse>
																			<MainLibrary.Exec name="AddTable" author="YoussefB" creation-date="2023-03-01T11:14:15" modification-date="2023-03-08T09:48:25">
																				<library-description>To execute valid Python code.</library-description>
																				<command>
																					
																					if len(_AD_.BalancingOFFList) != 0:
																					    reportlibrary.AddHTML('&lt;h3&gt;Balancing OFF&lt;/h3&gt;')
																					    reportlibrary.AddTable(["Cell Info", "Value"], Data = { "Min_CellSOC" : round(min(_AD_.SOCOFF[1]),4),"Max_CellSOC" : round(max(_AD_.SOCOFF[1]),4)})
																					    
																					if len(_AD_.BalancingONList) != 0:
																					    reportlibrary.AddHTML('&lt;h3&gt;Balancing ON&lt;/h3&gt;')
																					    reportlibrary.AddTable(["Cell Info", "Value"], Data = { "Min_CellSOC" : round(min(_AD_.SOCON[1]),4),"Max_CellSOC" : round(max(_AD_.SOCON[1]),4)})
																					
																					
																				</command>
																			</MainLibrary.Exec>
																			<MainLibrary.Exec name="Plotting" author="YoussefB" creation-date="2023-02-15T08:42:32" modification-date="2023-03-02T08:30:04">
																				<library-description>To execute valid Python code.</library-description>
																				<command>
																					import tempfile
																					import os.path
																					import time
																					import matplotlib
																					import matplotlib.pyplot as plt
																					
																					
																					def FormatYTick(y,pos): 
																					    data = {0:"OFF", 1 : "ON"}
																					    try: 
																					            return f'{data[y]}({int(y)})'
																					    except: 
																					            return f'{int(y)}'
																					    
																					
																					_AD_.TempFileName.PathName = os.path.join(
																					                                tempfile.gettempdir(),
																					                                "img%s.svg"%( str( int(time.time()*10000) ) ) )
																					
																					# Create a matplotlib figure
																					# Note that arguments are used here: (width,height) : where width and height are in inch
																					fig= matplotlib.figure.Figure((15,8))
																					
																					
																					# Create the first subplot
																					
																					### Create the first subplot and plot data. Note the figure coordinates
																					##subplot1= fig.add_axes( [0.08, 0.7, 0.9, 0.2], title="Cell Voltage" )
																					##subplot1.plot( _AD_.Voltage[0], _AD_.Voltage[1], 'b', linewidth=1)
																					##subplot1.grid(True, which='major', linestyle='-', linewidth=0.5, color='lightgrey', zorder=0)    
																					##
																					##subplot1.yaxis.set_minor_locator( matplotlib.ticker.AutoMinorLocator(4))
																					##subplot1.xaxis.set_minor_locator( matplotlib.ticker.AutoMinorLocator(4))
																					##
																					# Create the second subplot and plot data. Note the figure coordinates
																					subplot1= fig.add_axes( [0.08, 0.55, 0.9, 0.35], title="Cell SOC" )
																					subplot1.plot( _AD_.SOC[0],  _AD_.SOC[1], 'b',linewidth=1  )
																					subplot1.grid(True, which='major', linestyle='-', linewidth=0.5, color='lightgrey', zorder=0)
																					
																					subplot1.yaxis.set_minor_locator( matplotlib.ticker.AutoMinorLocator(4))
																					subplot1.xaxis.set_minor_locator( matplotlib.ticker.AutoMinorLocator(4))
																					
																					# Create the third subplot and plot data. Note the figure coordinates
																					subplot2= fig.add_axes( [0.08, 0.05, 0.9,0.35], title="Cell Balancing Status" )
																					subplot2.plot( _AD_.BalancingStatus[0],  _AD_.BalancingStatus[1], 'b',linewidth=1  )
																					subplot2.grid(True, which='major', linestyle='-', linewidth=0.5, color='lightgrey', zorder=0)
																					
																					subplot2.yaxis.set_minor_locator( matplotlib.ticker.AutoMinorLocator(4))
																					subplot2.xaxis.set_minor_locator( matplotlib.ticker.AutoMinorLocator(4))
																					subplot2.yaxis.set_major_formatter( matplotlib.ticker.FuncFormatter(FormatYTick) )
																					subplot2.yaxis.set_major_locator( matplotlib.ticker.MultipleLocator(1))
																					
																					
																					
																					
																					# Specify the SVG backend to be used for drawing and save your figures to file
																					fig.set_canvas( matplotlib.backends.backend_svg.FigureCanvasSVG( fig ) )
																					    
																					# save the file as png image
																					fig.savefig( _AD_.TempFileName.PathName, dpi=80 )
																					    
																					# clear the figure
																					fig.clear()
																					    
																					reportlibrary.AddImage(_AD_.TempFileName.GetAbsolutePath())
																					    
																					# clean-up exec namespace
																					del subplot1
																					del subplot2
																					del fig
																					
																					    
																					    
																					
																				</command>
																			</MainLibrary.Exec>
																			<MainLibrary.Exec name="BalancingBehaviourEval" author="YoussefB" creation-date="2023-03-02T11:33:15" modification-date="2023-03-07T11:58:15">
																				<library-description>To execute valid Python code.</library-description>
																				<command>
																					##BalancingOFFVerdict = 1
																					##BalancingONVerdict = 1
																					####
																					##if len(_AD_.BalancingOFFList) != 0:
																					##        if round(max(_AD_.SOCOFF[1]),4) &lt;= _AD_.BalancingSessionConfig.SOCThreshhold:        
																					##                BalancingOFFVerdict = 1
																					##        else :  
																					##                BalancingOFFVerdict = 0
																					##                                                
																					##
																					##if len(_AD_.BalancingONList) != 0:
																					##        if round(min(_AD_.SOCON[1]),4) &gt;= _AD_.BalancingSessionConfig.SOCThreshhold:        
																					##                BalancingONVerdict = 1
																					##        else :                                       
																					##                BalancingONVerdict = 0                                                
																					##          
																					                
																					if len(_AD_.BalancingONList) == 0 :
																					        _AD_.Styling =_AD_.Styling + f'''td#{_AD_.TableCellID[_AD_.Current]}{{
																					                background-color:#d1cdcd;
																					                }}\n''' 
																					else :
																					       _AD_.Styling = _AD_.Styling + f'''td#{_AD_.TableCellID[_AD_.Current]}{{
																					                                             background-color:#D3FFCA;
																					                                                }}\n'''
																					    
																					##    if BalancingOFFVerdict == 1 and BalancingONVerdict == 1:
																					##        
																					##         _AD_.Styling = _AD_.Styling + f'''td#{_AD_.TableCellID[_AD_.Current]}{{
																					##                                             background-color:#D3FFCA;
																					##                                                }}\n'''
																					##                                                
																					##    else :
																					##        
																					##         _AD_.Styling = _AD_.Styling + f'''td#{_AD_.TableCellID[_AD_.Current]}{{
																					##                                                background-color:#FFCACA;
																					##                                                }}\n'''
																					##
																					   
																					
																					
																				</command>
																			</MainLibrary.Exec>
																		</subsystems>
																	</MainLibrary.For>
																	<MainLibrary.Exec name="CloseStyling" author="YoussefB" creation-date="2023-02-14T09:43:07" modification-date="2023-03-01T11:04:11">
																		<library-description>To execute valid Python code.</library-description>
																		<command>
																			_AD_.Styling = _AD_.Styling + "&lt;/style&gt;"
																			
																		</command>
																	</MainLibrary.Exec>
																	<Report.AddHTML name="AddHTML" author="YoussefB" creation-date="2023-02-14T09:31:58" modification-date="2023-03-01T11:04:11">
																		<library-description>
																			Add XHTML Markup to the report. The markup is visible in HTML and adopted for PDF reports.
																			Invalid markup is shown as source.
																		</library-description>
																		<MarkupText name="MarkupText" reference="Styling" modification-date="2023-03-01T11:04:11">
																			<value></value>
																		</MarkupText>
																	</Report.AddHTML>
																	<Evaluation.GetSignalFromXILAPICaptureResult name="GetSOCImbalance" author="YoussefB" creation-date="2023-02-24T13:37:56" modification-date="2023-03-01T12:17:56">
																		<library-description>To get a signal by converting data extracted from a XILAPI CaptureResult.</library-description>
																		<CaptureResult name="CaptureResult" reference="CaptureResult" modification-date="2023-02-24T13:38:19">
																			<value></value>
																		</CaptureResult>
																		<Task name="Task" reference="TaskName" modification-date="2023-02-24T13:38:22">
																			<value></value>
																		</Task>
																		<VariableName name="VariableName" reference="Mapping.LabelMapping.GetSOCImbalance.Identifier" modification-date="2023-03-01T12:18:19">
																			<value></value>
																		</VariableName>
																		<Signal name="Signal" reference="SOCImbalance" modification-date="2023-03-01T12:18:00">
																			<value>[], []</value>
																		</Signal>
																	</Evaluation.GetSignalFromXILAPICaptureResult>
																	<MainLibrary.Exec name="Round" author="YoussefB" creation-date="2023-02-24T13:59:55" modification-date="2023-03-01T12:32:29">
																		<library-description>To execute valid Python code.</library-description>
																		<command>_AD_.MinSOCImbalance = round(_AD_.MinSOCImbalance,3)</command>
																	</MainLibrary.Exec>
																	<Evaluation.GetConditionTrueTimes name="GetConditionTrueTimes" author="YoussefB" creation-date="2023-02-24T13:39:32" modification-date="2023-02-24T13:39:45">
																		<library-description>To get the time values of a signal where a specified condition is fulfilled.</library-description>
																		<Condition name="Condition" modification-date="2023-03-01T12:19:02">
																			<value>SOCImbalance &lt;= 0.001</value>
																		</Condition>
																		<xAxis name="X-Axis" modification-date="2023-02-24T13:39:32">
																			<value>Union</value>
																		</xAxis>
																		<Interpolation name="Interpolation" modification-date="2023-02-24T13:39:32">
																			<value>Linear</value>
																		</Interpolation>
																		<ConditionTrueTimes name="ConditionTrueTimes" reference="SOCImbalanceTrueTimes" modification-date="2023-03-01T12:18:47">
																			<value type="expr">[]</value>
																		</ConditionTrueTimes>
																		<Result name="Result" modification-date="2023-02-24T13:39:32">
																			<value>[], []</value>
																		</Result>
																		<data-objects>
																			<Evaluation.Signal name="SOCImbalance" reference="SOCImbalance" author="YoussefB" creation-date="2023-02-24T13:39:45" modification-date="2023-03-01T12:18:56" id="{6A78E85E-3EBC-4267-8872-A58767C62A10}">
																				<library-description>A signal data object consisting of (x,y) value pairs.</library-description>
																				<value>[], []</value>
																			</Evaluation.Signal>
																		</data-objects>
																	</Evaluation.GetConditionTrueTimes>
																	<FrameworkBuilder.Frame name="Eval SOC Imbalance" library-link="Test Builder.Step" state="library-link" author="YoussefB" creation-date="2023-03-07T10:42:40" modification-date="2023-03-07T10:42:47" color="#7FFFD4">
																		<library-description>
																			
																			To provide an element for grouping automation blocks that represent a functional unit.
																			
																			HELP: automationdesk:///AutomationDeskDocumentation?Show=Help#12600003
																		</library-description>
																		<parameters>
																			<MainLibrary.Dictionary name="Attributes" data-direction="in" author="dSPACE GmbH" creation-date="2012-08-01T01:00:00" modification-date="2023-03-07T10:42:40" id="{E19A5583-E642-425E-8DD3-B8BEF7A44F2C}">
																				<value type="expr">{}</value>
																			</MainLibrary.Dictionary>
																		</parameters>
																		<subsystems>
																			<FrameworkBuilder.ActualOperationSlot name="Body" author="YoussefB" creation-date="2023-03-07T10:42:40" modification-date="2023-03-07T10:42:42">
																				<library-description>
																					To define meta templates.
																					This block must be used inside a Frame to define a slot for blocks.
																				</library-description>
																				<subsystems>
																					<MainLibrary.Exec name="SOCImbalance" author="YoussefB" creation-date="2023-03-06T15:16:13" modification-date="2023-03-07T11:02:32">
																						<library-description>To execute valid Python code.</library-description>
																						<command>
																							import tempfile
																							import os.path
																							import time
																							import matplotlib
																							
																							
																							
																							if len(_AD_.BalancingStartList) != 0:
																							    BalancingStartTimeStamp = min(_AD_.BalancingStartList)
																							    
																							    Index = _AD_.SOCImbalance.GetIndex(BalancingStartTimeStamp)
																							    
																							    Slope = (_AD_.SOCImbalance[1][-1] - _AD_.SOCImbalance[1][Index] )/ (_AD_.SOCImbalance[0][-1] - _AD_.SOCImbalance[0][Index] )
																							    
																							    reportlibrary.AddTable(["BalancingInfo", "Values"], Data = {"Balancing StartTimeStamp" : round(BalancingStartTimeStamp,3), "Starting Imbalance" : round(_AD_.SOCImbalance[1][Index],4), "Current Imbalance" : round(_AD_.SOCImbalance[1][-1],4), "Slope" : round(Slope,5)})
																							    
																							    _AD_.TempFileName.PathName = os.path.join(
																							                                    tempfile.gettempdir(),
																							                                    "img%s.svg"%( str( int(time.time()*10000) ) ) )
																							    
																							    # Create a matplotlib figure
																							    # Note that arguments are used here: (width,height) : where width and height are in inch
																							    fig= matplotlib.figure.Figure((15,4))
																							    
																							    
																							    # Create the first subplot
																							    
																							    # Create the first subplot and plot data. Note the figure coordinates
																							    subplot1= fig.add_axes( [0.05, 0.1, 0.9, 0.8], title="SOC Imbalance" )
																							    subplot1.plot( _AD_.SOCImbalance[0], _AD_.SOCImbalance[1], 'b', linewidth=1 )
																							    subplot1.grid(True, which='major', linestyle='-', linewidth=0.5, color='lightgrey', zorder=0)    
																							    subplot1.yaxis.set_minor_locator( matplotlib.ticker.AutoMinorLocator(5)) 
																							    subplot1.xaxis.set_minor_locator( matplotlib.ticker.AutoMinorLocator(5))
																							    subplot1.yaxis.set_major_locator( matplotlib.ticker.MaxNLocator(integer = True))
																							       
																							    # Specify the SVG backend to be used for drawing and save your figures to file
																							    fig.set_canvas( matplotlib.backends.backend_svg.FigureCanvasSVG( fig ) )
																							        
																							    # save the file as png image
																							    fig.savefig( _AD_.TempFileName.PathName, dpi=80 )
																							        
																							    # clear the figure
																							    fig.clear()
																							        
																							    reportlibrary.AddImage(_AD_.TempFileName.GetAbsolutePath())
																							        
																							    # clean-up exec namespace
																							    del subplot1
																							    del fig    
																							    
																							    if Slope &lt; 0:
																							        mainlibrary.Decision("Passed", "SOC Imbalance is Decreasing")
																							    if Slope &gt; 0:
																							        mainlibrary.Decision("Failed", "SOC Imbalance is Increasing")
																							    if Slope == 0:
																							        mainlibrary.Decision("Failed", "SOC Imbalance is constant")
																							        
																							
																							 
																							else :
																							    mainlibrary.Decision("Undefined","Balancing not Started")
																							
																							
																							
																							
																							
																						</command>
																					</MainLibrary.Exec>
																				</subsystems>
																			</FrameworkBuilder.ActualOperationSlot>
																		</subsystems>
																	</FrameworkBuilder.Frame>
																	<MainLibrary.Serial name="Serial" author="YoussefB" creation-date="2023-03-06T15:08:58" modification-date="2023-03-07T10:42:42">
																		<library-description>To execute subsystems sequentially.</library-description>
																		<data-objects>
																			<MainLibrary.List name="XAxis" author="YoussefB" creation-date="2023-03-06T15:16:16" modification-date="2023-03-06T15:16:21" id="{055DC2AB-AF9D-4B27-9564-8339C0AE85E5}">
																				<value type="expr">[]</value>
																			</MainLibrary.List>
																			<Evaluation.Signal name="Signal" author="YoussefB" creation-date="2023-03-06T15:16:45" modification-date="2023-03-06T15:16:45" id="{C5701310-0185-42A4-BD36-D2F2CB8CDC25}">
																				<library-description>A signal data object consisting of (x,y) value pairs.</library-description>
																				<value>[], []</value>
																			</Evaluation.Signal>
																		</data-objects>
																	</MainLibrary.Serial>
																</subsystems>
															</MainLibrary.Serial>
														</subsystems>
													</FrameworkBuilder.ActualOperationSlot>
												</subsystems>
											</FrameworkBuilder.Frame>
											<Report.CreateSubreport name="Plots" author="YoussefB" creation-date="2023-02-24T14:08:11" modification-date="2023-03-01T12:44:13">
												<library-description>Report nested blocks to separate Result-XML file.</library-description>
												<LinkDescription name="LinkDescription" modification-date="2023-02-24T14:08:11">
													<value></value>
												</LinkDescription>
												<subsystems>
													<Standard.LibraryLinkBlock name="CustomPlotting" library-link="BMS.CustomPlotting" author="YoussefB" creation-date="2023-02-24T14:01:49" modification-date="2023-02-28T08:54:46">
														<library-description>A Serial that allows Custom Plotting via Matplotloib, and allows two sources of ploting (Mapping / Inner Mapping Dictionary)</library-description>
														<parameters>
															<XILAPI.CaptureResult name="CaptureResult" reference="CaptureResult" author="YoussefB" creation-date="2023-01-25T16:00:04" modification-date="2023-02-24T14:01:55" id="{8291F69A-C12F-4725-9A7E-D46B235468C3}">
																<value></value>
															</XILAPI.CaptureResult>
															<MainLibrary.List name="MeasurmentVars" reference="MainMeasurmentVars" data-direction="in" author="YoussefB" creation-date="2023-01-25T16:00:05" modification-date="2023-03-01T10:48:32" id="{67AAAA8A-65C0-4233-A9CD-D24D4BDD018E}">
																<value type="expr">[]</value>
															</MainLibrary.List>
															<MainLibrary.Bool name="InternalMapping" data-direction="in" author="YoussefB" creation-date="2023-02-24T14:03:48" modification-date="2023-03-01T10:48:39">
																<value>false</value>
															</MainLibrary.Bool>
															<MainLibrary.Dictionary name="OptionalInternalMapping" author="YoussefB" creation-date="2023-02-24T14:04:32" modification-date="2023-03-01T10:48:34" id="{E7577EBD-29F4-4B2E-98FD-DE710916741F}">
																<value type="expr">{}</value>
															</MainLibrary.Dictionary>
															<MainLibrary.List name="CellSignalNames" author="YoussefB" creation-date="2023-02-24T14:18:42" modification-date="2023-03-01T10:48:34" id="{E0CBADF8-A3B6-4FF5-913F-9524D4F58FD1}">
																<value type="expr">[]</value>
															</MainLibrary.List>
														</parameters>
													</Standard.LibraryLinkBlock>
												</subsystems>
											</Report.CreateSubreport>
										</subsystems>
									</MainLibrary.Serial>
									<FrameworkBuilder.Frame name="EvalData" state="block" author="YoussefB" creation-date="2023-02-24T14:43:38" modification-date="2023-02-24T14:43:44">
										<library-description>
											To define meta templates.
											This block must be used as root element for meta templates.
										</library-description>
										<subsystems>
											<FrameworkBuilder.Frame name="Eval" state="block" author="YoussefB" creation-date="2023-02-24T14:43:40" modification-date="2023-02-24T14:43:55">
												<library-description>
													To define meta templates.
													This block must be used as root element for meta templates.
												</library-description>
												<data-objects>
													<XILAPI.CaptureResult name="CaptureResult" reference="CaptureResult" author="YoussefB" creation-date="2023-02-24T14:43:55" modification-date="2023-02-24T14:43:57" id="{D2599C48-623F-4C95-B70F-7E8172BB4ED0}">
														<value></value>
													</XILAPI.CaptureResult>
												</data-objects>
											</FrameworkBuilder.Frame>
										</subsystems>
									</FrameworkBuilder.Frame>
								</subsystems>
							</If>
							<Else modification-date="2023-03-07T12:17:02">
								<subsystems>
									<FrameworkBuilder.Frame name="GetFailedPreConditionCaptureResult" library-link="Test Builder.Step" state="library-link" author="YoussefB" creation-date="2023-03-06T08:43:45" modification-date="2023-03-07T12:17:02" color="#7FFFD4">
										<library-description>
											
											To provide an element for grouping automation blocks that represent a functional unit.
											
											HELP: automationdesk:///AutomationDeskDocumentation?Show=Help#12600003
										</library-description>
										<parameters>
											<MainLibrary.Dictionary name="Attributes" data-direction="in" author="dSPACE GmbH" creation-date="2012-08-01T01:00:00" modification-date="2023-03-07T12:17:02" id="{FC30E32A-4592-4886-B4AF-9331066A0A3C}">
												<value type="expr">{}</value>
											</MainLibrary.Dictionary>
										</parameters>
										<subsystems>
											<FrameworkBuilder.ActualOperationSlot name="Body" author="YoussefB" creation-date="2023-03-06T08:43:45" modification-date="2023-03-07T12:17:02">
												<library-description>
													To define meta templates.
													This block must be used inside a Frame to define a slot for blocks.
												</library-description>
												<subsystems>
													<Standard.LibraryLinkBlock name="GetCaptureResult" library-link="XIL API Convenience.GetCaptureResult" author="YoussefB" creation-date="2023-01-13T13:15:36" modification-date="2023-03-07T12:17:02" color="#FFA500">
														<library-description>
															To get data from the capture and set the capture state.
															
															HELP: automationdesk:///AutomationDeskDocumentation?Show=Help#12502006
														</library-description>
														<parameters>
															<XILAPI.Capture name="Capture" reference="Capture" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-03-07T12:17:02"></XILAPI.Capture>
															<MainLibrary.Int name="StopCapturing" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-03-07T12:17:02">
																<value>1</value>
															</MainLibrary.Int>
															<MainLibrary.Int name="WhenFinished" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-03-07T12:17:02">
																<value>0</value>
															</MainLibrary.Int>
															<MainLibrary.Dictionary name="CaptureResultMetaData" data-direction="out" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-03-07T12:17:02" id="{629C3042-235D-432D-B817-C34192168146}">
																<value type="expr">{}</value>
															</MainLibrary.Dictionary>
															<XILAPI.CaptureResult name="CaptureResult" reference="CaptureResult" data-direction="out" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-03-07T12:17:02" id="{16DBA30D-1D5A-4DD7-8510-0D9D8E15925E}">
																<value></value>
															</XILAPI.CaptureResult>
															<XILAPI.CaptureResult name="OfflineCaptureResult" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-03-07T12:17:02" id="{2BC1CD4D-657A-4FFD-9614-305DE0BD9B65}">
																<value></value>
															</XILAPI.CaptureResult>
															<MainLibrary.Dictionary name="OfflineCaptureResultMetaData" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-03-07T12:17:02" id="{3789A8DF-0903-4D4D-805B-D43711AE4A21}">
																<value type="expr">
																	{'StartTriggerTimeOut':'FALSE',
																	 'StopTriggerTimeOut':'FALSE'}
																</value>
															</MainLibrary.Dictionary>
														</parameters>
													</Standard.LibraryLinkBlock>
												</subsystems>
											</FrameworkBuilder.ActualOperationSlot>
										</subsystems>
									</FrameworkBuilder.Frame>
								</subsystems>
							</Else>
						</MainLibrary.IfThenElse>
					</subsystems>
				</FrameworkBuilder.ActualOperationSlot>
				<FrameworkBuilder.ActualOperationSlot name="Cleanup" author="YoussefB" creation-date="2023-02-24T11:56:37" modification-date="2023-02-24T14:44:07">
					<library-description>
						To define meta templates.
						This block must be used inside a Frame to define a slot for blocks.
					</library-description>
					<subsystems>
						<Standard.LibraryLinkBlock name="CleanUp" library-link="BMS.CleanUp" author="YoussefB" creation-date="2023-02-24T13:47:47" modification-date="2023-02-28T08:54:46">
							<library-description>A serial that Contains Common Cleanup Steps, that are called at the Cleanup phase of Testcases</library-description>
						</Standard.LibraryLinkBlock>
						<FrameworkBuilder.DataSlot name="CleanupData" author="YoussefB" creation-date="2023-02-24T14:44:06" modification-date="2023-02-24T14:44:12">
							<library-description>
								To define meta templates.
								This block must be used inside a Frame to define dataobject slots.
							</library-description>
							<subsystems>
								<FrameworkBuilder.OperationSlot name="CleanUp" author="YoussefB" creation-date="2023-02-24T14:44:03" modification-date="2023-02-24T14:44:21">
									<library-description>
										To define meta templates.
										This block must be used inside a Frame to define a slot for blocks.
									</library-description>
								</FrameworkBuilder.OperationSlot>
							</subsystems>
						</FrameworkBuilder.DataSlot>
						<Standard.LibraryLinkBlock name="ReleaseCapture" library-link="XIL API Convenience.ReleaseCapture" author="YoussefB" creation-date="2023-02-24T13:48:04" modification-date="2023-02-24T13:48:04">
							<library-description>
								Performs application-defined tasks associated with freeing, releasing, or resetting unmanaged resources.
								Release the handle to the internal capture instance.
								
								HELP: automationdesk:///AutomationDeskDocumentation?Show=Help#12502011
							</library-description>
							<parameters>
								<XILAPI.Capture name="Capture" reference="Capture" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-02-24T13:48:07"></XILAPI.Capture>
							</parameters>
						</Standard.LibraryLinkBlock>
						<Standard.LibraryLinkBlock name="ReleaseMAPort" library-link="XIL API Convenience.ReleaseMAPort" author="YoussefB" creation-date="2023-02-24T13:47:57" modification-date="2023-02-24T13:47:57">
							<library-description>
								Performs application-defined tasks associated with freeing, releasing, or resetting unmanaged resources. If this method is called at a port instance, the port instance is destroyed and cannot be reused afterwards.
								HELP: automationdesk:///AutomationDeskDocumentation?Show=Help#12501006
							</library-description>
							<parameters>
								<XILAPI.MAPort name="MAPort" reference="MAPort" data-direction="in" author="dSPACE GmbH" creation-date="2015-01-01T00:00:00" modification-date="2023-02-24T13:48:10"></XILAPI.MAPort>
							</parameters>
						</Standard.LibraryLinkBlock>
					</subsystems>
				</FrameworkBuilder.ActualOperationSlot>
			</subsystems>
		</FrameworkBuilder.ActualDataSlot>
	</subsystems>
</FrameworkBuilder.SequenceFrame>